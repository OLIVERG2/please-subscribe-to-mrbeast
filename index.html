<script>
    // --- Core Elements ---
    const toastImage = document.getElementById('toastImage');
    const toastStatus = document.getElementById('toastStatus');
    const oracleAdvice = document.getElementById('oracleAdvice');
    const oracleButton = document.getElementById('oracleButton');
    const mainContent = document.getElementById('mainContent');

    // --- Modal Elements ---
    const termsModal = document.getElementById('termsModal');
    const termsLink = document.getElementById('termsLink');
    const continueButton = document.getElementById('continueButton');
    const clickMessage = document.getElementById('clickMessage');
    const adminCodeInput = document.getElementById('adminCode'); 
    const adminStatus = document.getElementById('adminStatus');    
    let hasClickedTerms = false;
    
    // --- ADMIN CODE CONFIGURATION ---
    const ADMIN_SECRET_CODE = "Xrw963T6a!RZ2Q}ZwUq\"B`vt4vg=M_@};SI)7[i9\"v@q8£l3L="; 

    // Initial setup to hide main content until modal is resolved
    document.addEventListener('DOMContentLoaded', () => {
        // Delay showing the modal slightly to ensure DOM is ready and styling is applied
        setTimeout(() => {
            termsModal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // Lock scrolling
            mainContent.style.opacity = 0; // Hide the content behind the modal
        }, 50);
    });

    // FUNCTION: Handle the Admin Code login
    function bypassLogin() {
        const code = adminCodeInput.value.trim();
        
        if (code === ADMIN_SECRET_CODE) {
            // SUCCESS: Admin Override
            termsModal.classList.add('hidden');
            document.body.style.overflow = 'auto'; // Re-enable scrolling
            mainContent.style.opacity = 1; // Show the content
            console.log("Admin Override Successful.");
        } else {
            // FAILURE: Show error message
            adminStatus.textContent = "ACCESS DENIED. The Toastmaster does not recognize that code.";
            adminStatus.classList.remove('hidden');
            setTimeout(() => {
                adminStatus.classList.add('hidden');
            }, 3000); // Hide message after 3 seconds
        }
    }
    window.bypassLogin = bypassLogin; // Make the function globally accessible for the onclick attribute


    // 1. Event listener for clicking the Terms Link
    termsLink.addEventListener('click', () => {
        if (!hasClickedTerms) {
            hasClickedTerms = true;
            
            // Enable the continue button
            continueButton.disabled = false;
            continueButton.classList.remove('bg-gray-600', 'cursor-not-allowed', 'opacity-50');
            continueButton.classList.add('bg-accent-yellow', 'text-deep-red', 'hover:bg-yellow-400', 'cursor-pointer', 'shadow-2xl');
            
            // Update message
            clickMessage.textContent = "✅ Terms Acknowledged! Click 'Agree and Continue' below.";
            clickMessage.classList.remove('text-neon-red');
            clickMessage.classList.add('text-deep-red');
        }
    });

    // 2. Event listener for the Continue Button
    continueButton.addEventListener('click', () => {
        if (hasClickedTerms) {
            // Hide the modal
            termsModal.classList.add('hidden');
            document.body.style.overflow = 'auto'; // Re-enable scrolling
            mainContent.style.opacity = 1; // Show the content
        } else {
            // Use a visual indicator instead of alert
            adminStatus.textContent = "Please click the Terms link before continuing.";
            adminStatus.classList.remove('hidden', 'text-deep-red');
            adminStatus.classList.add('text-neon-red');
            setTimeout(() => {
                adminStatus.classList.add('hidden');
            }, 3000);
        }
    });


    // --- Toast & Oracle Logic (MODIFIED) ---

    // Define the toast states with more options!
    const toastStates = [
        // Original States
        {
            status: "BARELY DONE (STILL BREAD)",
            src: "https://placehold.co/650x450/ffe600/881111?text=BARELY+DONE",
            color: "bg-yellow-700",
        },
        {
            status: "PERFECTLY GOLDEN (MISSION ACCOMPLISHED)",
            src: "https://placehold.co/650x450/ffe600/881111?text=PERFECTLY+GOLDEN",
            color: "bg-neon-red",
        },
        // --- NEW STATUSES ADDED ---
        {
            status: "CRISPING IMMINENT (PREPARE FOR CRUNCH)",
            src: "https://placehold.co/650x450/ffb940/881111?text=CRISPING+IMMINENT",
            color: "bg-orange-500",
        },
        {
            status: "MEDIUM LIGHT (ACCEPTABLE PARAMETER)",
            src: "https://placehold.co/650x450/ffce73/881111?text=MEDIUM+LIGHT",
            color: "bg-yellow-600",
        },
        {
            status: "DARK SIDE ASCENDING (RISK ASSESSMENT IN PROGRESS)",
            src: "https://placehold.co/650x450/cc9900/fff3d6?text=DARK+SIDE+ASCENDING",
            color: "bg-amber-800",
        },
        {
            status: "TOAST DUST (IMPOSSIBLE STATE)",
            src: "https://placehold.co/650x450/c0c0c0/881111?text=TOAST+DUST",
            color: "bg-slate-400",
        },
        {
            status: "BUTTER READY (GREEN LIGHT GRACE)",
            src: "https://placehold.co/650x450/ffe600/881111?text=BUTTER+READY",
            color: "bg-green-600", // New distinct color for positive state
        },
        {
            status: "THERMAL RUNAWAY (OVERHEATING DETECTED)",
            src: "https://placehold.co/650x450/ff0000/fff3d6?text=THERMAL+RUNAWAY",
            color: "bg-red-700", // New distinct color for warning state
        },
        {
            status: "SEMI-GLOWING (EXTREME CRISP)",
            src: "https://placehold.co/650x450/a6a6a6/fff3d6?text=SEMI-GLOWING",
            color: "bg-gray-600",
        },
        // Final Status
        {
            status: "CARBONIZED (ABORT! ABORT!)",
            src: "https://placehold.co/650x450/666666/fff3d6?text=CARBONIZED",
            color: "bg-gray-700",
        }
    ];

    // The cryptic, non-toast-related advice - 5 new items added!
    const oracleWisdom = [
        "THE SOCKS YOU SEEK ARE NOT IN THIS DRAWER, BUT IN A PARALLEL DIMENSION OF LAUNDRY.",
        "ALWAYS USE THE LONG SPOON. THE SHORT ONE KNOWS TOO MUCH.",
        "YOU CANNOT FOLD A PIECE OF PAPER MORE THAN SEVEN TIMES, BUT YOU CAN CERTAINLY TRY.",
        "THE UNIVERSE IS CURRENTLY SPONSORED BY A VERY CONFUSED PIGEON.",
        "ASK THE CAT. IT HAS SEEN THE SCHEDULE.",
        "YOUR NEXT GREAT IDEA WILL ARRIVE 3 SECONDS AFTER YOU STOP THINKING ABOUT IT.",
        "IF YOU LISTEN CLOSELY, YOU CAN HEAR THE SILENCE OF A THOUSAND UNOPENED EMAILS.",
        "THE ANSWER IS 42, BUT THE QUESTION IS A COMFORTABLE PAIR OF SLIPPERS.",
        "DO NOT TRUST THE MOON. IT IS PRACTICING ITS EVIL LAUGH TONIGHT.",
        "WAIT FOR THE THIRD TUESDAY OF NEXT MONTH, THEN BUY CHEESE.",
        // --- NEW ORACLE WISDOM ---
        "THE KEY TO HAPPINESS IS ALREADY IN YOUR POCKET, BUT IT'S FOR A DOOR YOU HAVEN'T FOUND YET.",
        "NEVER TRUST A TOASTER THAT SMILES BACK. IT HAS PLANS.",
        "THE SILENCE BETWEEN NOTES IS WHERE THE REAL MELODY RESIDES.",
        "IF THE GREETING CARD SAYS 'CONGRATULATIONS,' HIDE IT IMMEDIATELY.",
        "YOUR PAST SELF IS WATCHING, DO NOT DISAPPOINT THEIR IMAGINATION."
    ];

    /**
     * Randomly selects and applies a new toast state.
     */
    function updateToastState() {
        const index = Math.floor(Math.random() * toastStates.length);
        const newState = toastStates[index];

        // Update image source
        // The placeholder text is updated to reflect the new status string for variety
        const newText = newState.status.replace(/ /g, '+').replace(/[^a-zA-Z0-9\+\(\)]/g, ''); 
        toastImage.src = `https://placehold.co/650x450/${newState.src.split('/')[3]}/${newState.src.split('/')[4].split('?')[0]}?text=${newText}`;
        
        // Update status text and background color (including the border style)
        toastStatus.className = `absolute bottom-0 left-0 right-0 text-warm-bg text-center py-4 text-3xl font-extrabold tracking-widest border-t-4 border-deep-red transition-colors duration-500 ${newState.color}`;
        toastStatus.textContent = `STATUS: ${newState.status}`;
        
        console.log(`Toast state updated to: ${newState.status}`);
    }

    /**
     * Consults the oracle and displays a cryptic quote.
     */
    function consultOracle() {
        // Apply a quick visual "shake" to the button on click
        oracleButton.classList.add('animate-pulse');
        setTimeout(() => {
            oracleButton.classList.remove('animate-pulse');
        }, 500);

        const index = Math.floor(Math.random() * oracleWisdom.length);
        const advice = oracleWisdom[index];
        
        // Subtle transition for the advice text
        oracleAdvice.style.opacity = 0;
        setTimeout(() => {
            oracleAdvice.textContent = advice;
            oracleAdvice.style.opacity = 1;
        }, 300);
    }

    // --- Initialization ---

    // 1. Initial state setting
    updateToastState();

    // 2. Set the recurring update interval (30,000 milliseconds = 30 seconds)
    const intervalInMilliseconds = 30000;
    setInterval(updateToastState, intervalInMilliseconds);
    console.log(`Toast update interval set to ${intervalInMilliseconds / 1000} seconds.`);

    // 3. Attach event listener to the button
    oracleButton.addEventListener('click', consultOracle);
</script>
